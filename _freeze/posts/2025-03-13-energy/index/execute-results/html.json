{
  "hash": "4151026b0aaf655d751642e0e4f42cfe",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Decoding Energy Patterns: Time Series Analysis of US Energy Consumption\"\nauthor: \"Zoe Zhou\"\ndate: 03-13-2025\nimage: preview.jpg\ncategories: [R, Modeling, Quarto]\nformat: \n  html:\n    code-fold: true\n    embed-resources: true\n    toc: true\nexecute:\n  warning: false\n  message: false\ntheme: minty\n---\n\n\n![Renewable Energy Examples by GMS](https://www.gmsthailand.com/wp-content/uploads/2023/12/Feature-Renewable-Energy.jpg)\n\n### Overview\nIn today's data-driven world, understanding energy consumption patterns isn't just for utility companies - it's valuable for everyone interested in sustainability, energy planning, or data science techniques. Join me as I explore residential energy consumption trends using powerful time series analysis methods in R.\n\n#### Data Summary\n\nwe will use data on US residential energy consumption from January 1973 - September 2023 (from the US Energy Information Administration).\n\n-   Dataset: U.S. Residential Energy Consumption (Jan 1973 - Sep 2023)\n-   Units: Trillion BTU\n-   Source: US Energy Information Administration (https://www.eia.gov/totalenergy/data/monthly/index.php)\n\n#### Objectives\n\n1. Examine patterns and trends in energy usage over this 50-year period\n2. Forecast consumption patterns five years into the future\n\n### Set up \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(lubridate)\nlibrary(tsibble) \nlibrary(feasts)\nlibrary(fable)\nlibrary(ggplot2)\n\nenergy_df <- read_csv(here(\"posts\", \"2025-03-13-energy\", \"data\", \"energy.csv\"))\n\nenergy_ts <- energy_df %>% \n  mutate(date = yearmonth(yrmonth)) %>% \n  as_tsibble(index = date, \n             key = sector)\n```\n:::\n\n\n\n### Visualizing Energy Consumption Trends\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a more presentable energy consumption trend visualization\nggplot(data = energy_ts, aes(x = date, y = energy_total, color = sector)) +\n  geom_line(linewidth = 0.9) +\n  labs(\n    title = \"U.S. Energy Consumption by Sector (1973-2023)\",\n    subtitle = \"Monthly data from the U.S. Energy Information Administration\",\n    x = \"Year\",\n    y = \"Energy Consumption (Trillion BTU)\",\n    color = \"Sector\"\n  ) +\n  theme_minimal() +\n  scale_color_manual(\n    values = c(\"residential\" = \"#3498DB\", \"commercial\" = \"#E74C3C\", \"industrial\" = \"#2ECC71\"),\n    labels = c(\"Residential\", \"Commercial\", \"Industrial\")\n  ) +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, NA)) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 12, color = \"gray40\"),\n    axis.title = element_text(face = \"bold\", size = 12),\n    axis.text = element_text(size = 10),\n    legend.position = \"bottom\",\n    legend.title = element_text(face = \"bold\"),\n    panel.grid.minor = element_line(color = \"gray95\"),\n    panel.grid.major = element_line(color = \"gray90\"),\n    plot.margin = margin(t = 20, r = 20, b = 20, l = 20)\n  ) +\n  guides(color = guide_legend(override.aes = list(linewidth = 2)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nLooking at the residential sector specifically, we can observe an overall increasing trend that eventually plateaus. There're strong seasonal patterns (more pronounced than in the industrial sector). In addition there's no obvious cyclical behavior beyond seasonality.\n\n#### Is there a seasonal pattern?\n\nA seasonplot can help point out seasonal patterns, and help to glean insights over the years. We'll use `feasts::gg_season()` to create an exploratory seasonplot, which has month on the x-axis, energy consumption on the y-axis, and each year is its own series (mapped by line color).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a more presentable seasonal plot for residential energy consumption\nenergy_ts %>% \n  filter(sector == 'residential') %>%\n  gg_season(y = energy_total, pal = hcl.colors(n = 10, palette = \"viridis\")) + \n  theme_minimal() +\n  labs(\n    title = \"Seasonal Patterns in U.S. Residential Energy Consumption\",\n    subtitle = \"Monthly patterns shown across different years (1973-2023)\",\n    x = \"Month\",\n    y = \"Energy Consumption (Trillion BTU)\",\n    color = \"Year\"\n  ) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 12, color = \"gray40\"),\n    axis.title = element_text(face = \"bold\", size = 12),\n    axis.text = element_text(size = 10),\n    axis.text.x = element_text(angle = 0),\n    legend.position = \"right\",\n    legend.title = element_text(face = \"bold\"),\n    panel.grid.minor = element_line(color = \"gray95\"),\n    panel.grid.major = element_line(color = \"gray90\"),\n    plot.margin = margin(t = 20, r = 20, b = 20, l = 20)\n  ) +\n  scale_x_discrete(\n    labels = c(\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\")\n  ) +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, NA))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThis visualization reveals two distinct usage peaks throughout the year: A primary winter peak (December-February), likely driven by heating needs and a secondary summer peak (June-August), likely due to air conditioning use. Interestingly, the summer peak has become more pronounced in recent years, potentially reflecting increased air conditioning adoption and climate change impacts.\n\nA subseries plot further confirms these patterns:\n\n<details><summary>Expand to see the subseries plot</summary>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenergy_ts %>% gg_subseries(energy_total)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n</details>\n\n\n### Decomposing the Time Series\nTo formally separate the components of our time series, I'll use STL decomposition (Seasonal and Trend decomposition using LOESS):\n\nSTL is a versatile and robust method for decomposing time series. STL is an acronym for “Seasonal and Trend decomposition using LOESS”, while LOESS is a method for estimating nonlinear relationships.\" LOESS (\"Locally estimated scatterplot smoothing\") uses a *weighted* moving average across *all* points in the dataset, weighted by distance from the point being averaged.\n\nNotice that it allows seasonality to vary over time (a major difference from classical decomposition, and important here since we do see changes in seasonality).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find STL decomposition\ndcmp <- energy_ts %>%\n  filter(sector == 'residential') %>%\n  model(feasts::STL(energy_total ~ season(period = '1 year') + trend(window = 25)))\n\n\n# Visualize the decomposed components\ncomponents(dcmp) %>% \n  autoplot() +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\nThis decomposition clearly identifies:\n\n- The seasonal component with its bi-modal pattern\n\n- A trend component showing the overall increase and plateau\n\n- A remainder component that captures the noise in the data\n\n### Autocorrelation Analysis\nTo further understand the temporal dependencies in our data, we can use autocorrelation plots (ACF). These plots help us identify the correlation of a time series with its own past values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenergy_ts %>% \n  filter(sector == 'residential') %>%\n  ACF(energy_total) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nLooking at the autocorrelation function (ACF) confirmed the strong seasonal pattern, with the highest correlation at 12-month intervals\n\n### Forecasting\n\nAfter understanding the historical patterns, I created a forecasting model using Exponential Smoothing (ETS). I specified a model with multiplicative seasonality and additive trend based on the change in variance over time and also within the secondary summer peak. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenergy_fit <- energy_ts %>%\n  filter(sector == 'residential') %>%\n  group_by_key(sector) %>%\n  model(ets = ETS(energy_total ~ season(method = \"M\") + trend(method = \"A\")))\n\nenergy_forecast <- energy_fit %>% \n  forecast(h = \"5 years\")\n\n# plot it added to the original data:\nenergy_forecast %>% \n  autoplot(energy_ts)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Model Validation\nTo validate the model's performance, I compared the predicted values against the actual data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenergy_predicted <- broom::augment(energy_fit)\n\n# Create a more presentable comparison of actual vs. predicted energy consumption\nggplot(data = energy_predicted) +\n  geom_line(aes(x = date, y = energy_total, color = \"Actual Consumption\"), linewidth = 0.8) +\n  geom_line(aes(x = date, y = .fitted, color = \"Model Prediction\"), linewidth = 0.8) +\n  labs(\n    title = \"U.S. Residential Energy Consumption: Actual vs. Predicted\",\n    subtitle = \"Comparing observed data with ETS model predictions (1973-2023)\",\n    x = \"Year\",\n    y = \"Energy Consumption (Trillion BTU)\",\n    color = \"Data Type\"\n  ) +\n  scale_color_manual(values = c(\"Actual Consumption\" = \"#2E86C1\", \"Model Prediction\" = \"darkorange\")) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    plot.subtitle = element_text(size = 10, color = \"gray30\"),\n    legend.position = \"bottom\",\n    legend.title = element_text(face = \"bold\"),\n    panel.grid.minor = element_line(color = \"gray90\"),\n    panel.grid.major = element_line(color = \"gray80\"),\n    axis.title = element_text(face = \"bold\"),\n    axis.text = element_text(size = 9)\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\nThe model appears to capture both the seasonal patterns and overall trend effectively, with residuals that are approximately normally distributed.\n\n#### Residual Analysis\n\nThe residuals appear roughly centered around zero, which is what we want to see. The distribution is approximately symmetric, suggesting our model isn't systematically over- or under-predicting. There are some slight deviations from perfect normality, which could indicate specific periods where the model struggled to capture all aspects of the data. But overall, This residual analysis gives us confidence that our ETS model is performing reasonably well, though there's always room for refinement. The residuals don't show strong evidence of systematic errors, suggesting that the model has captured the main patterns in the residential energy consumption data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = energy_predicted, aes(x = .resid)) +\n  geom_histogram(fill = \"#4682B4\", color = \"white\", bins = 30) +\n  labs(\n    title = \"Distribution of Model Residuals\",\n    subtitle = \"Assessing model performance through residual analysis\",\n    x = \"Residual Value (Actual - Predicted)\",\n    y = \"Frequency\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    plot.subtitle = element_text(color = \"gray30\")\n  ) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n### Conclusion\n\nThis analysis reveals several important insights about residential energy consumption in the United States:\n\n- The strong seasonal pattern has evolved to include both winter heating and summer cooling demands\n\n- Long-term growth appears to have plateaued in recent decades, possibly reflecting improved energy efficiency\n\n- The forecast suggests continuation of these patterns, with predictable seasonal fluctuations\n\nTime series analysis provides powerful tools for understanding patterns in data that change over time. For energy consumption, these insights could help utilities plan capacity, policymakers design energy efficiency programs, and consumers understand their usage patterns.\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}